function e(e){return null==e?"":String(e)}function t(e){let t=e.toString();return t=t.replace(/^\//,""),t=t.replace(/\/[mgiy]*$/,""),t}function n(e){return String(e).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}function r(r,i,u){let a="";if("function"!=typeof u){let e=new l(u);u=t=>e.evaluate(t)}if(i.flags&&i.flags.indexOf("g")>-1?i=function(e){let n=e.flags.replace("g","");return new RegExp(t(e),n)}(i):"string"==typeof i&&(i=n(i)),!i)return(u=u(""))+r.split("").join(u)+u;for(;r.length>0;){let t=r.length,n=r.match(i);if(n){let l,i=u(n,r);if(Array.isArray(i)&&([i,l]=i),a+=r.slice(0,n.index),a+=e(i),(r=void 0!==l?r.slice(n.index+l):r.slice(n.index+n[0].length)).length===t)throw new Error("Infinite loop detected; none of the string was consumed.")}else a+=r,r=""}return a}class l{constructor(e){this.template=String(e),this.pattern=l.DEFAULT_PATTERN}evaluate(t){return r(this.template,this.pattern,(n=>{if(null==t)return"";let r=n[1]||"";if("\\"==r)return n[2];let l=t,i=n[3],u=/^([^.[]+|\[((?:.*?[^\\])?)\])(\.|\[|$)/;if(null==(n=u.exec(i)))return r;for(;null!=n;){if(l=l["["===n[1].charAt(0)?n[2].replace(/\\]/,"]"):n[1]],null==l||""===n[3])break;i=i.substring("["===n[3]?n[1].length:n[0].length),n=u.exec(i)}return r+e(l)}))}}l.DEFAULT_PATTERN=/(^|.|\r|\n)(#\{(.*?)\})/,l.interpolate=function(e,t){return new l(e).evaluate(t)};export{l as default,n as escapeRegExp,r as gsub,t as regExpToString};
